<!DOCTYPE html>
<html>
<head>
    <title>上传文件</title>
    <meta charset="UTF-8">
    <!-- Import style -->
    <link rel="stylesheet" href="//unpkg.com/element-plus/dist/index.css" />
    <!-- Import Vue 3 -->
    <script src="//unpkg.com/vue@3"></script>
    <!-- Import component library -->
    <script src="//unpkg.com/element-plus"></script>

    <script src="//unpkg.com/axios/dist/axios.min.js"></script>

</head>
<body>
<div id="app">

    <el-page-header :icon="null">
        <template #content>
            <span class="text-large font-800 mr-3"> 简历解析系统 </span>
        </template>
    </el-page-header>

    <el-divider></el-divider>

    <h2>请选择上传文件或者文本</h2>
    <el-upload
            ref="upload"
            class="upload-demo"
            action="https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15"
            :limit="1"
            :on-exceed="handleExceed"
            :auto-upload="false"
    >
        <el-button size="small" type="primary" @click="onFileSubmit">点击上传</el-button>
        <div slot="tip" class="el-upload__tip">只能上传pdf/docx/jpg/jpeg/png文件，且不超过5Mb</div>
    </el-upload>
    <el-button type="success" @click="onFileSubmit">上传</el-button>

    <el-divider></el-divider>

    <el-form :model="form" label-width="120px">
        <el-form-item label="请输入文本简历123">
            <el-input v-model="resumetext" type="textarea" />
        </el-form-item>

        <el-form-item>
            <el-button type="primary" @click="onTextSubmit">提交</el-button>
            <el-button>取消</el-button>
        </el-form-item>
    </el-form>

</div>

<script>
    const App = {
        data() {
            return {
                el: "#app",
                resumetext: "12312",
            };
        }
    };
    // submit
    App.methods = {
        onTextSubmit() {
            console.log(this.resumetext);
            // 调用 ./uploadFile
            // let axios = require('axios');
            const formData = new FormData();
            formData.append('text', this.resumetext);
            axios.post('/uploadText', formData, {
                headers: {
                    'Content-Type': 'multipart/form-data'
                }
            }).then(response => {
                // 请求成功的处理逻辑
                this.$message({
                    message: "提交成功",
                    type: "success"
                });
                console.log(response.data);
            })
                .catch(error => {
                    // 请求失败的处理逻辑
                    this.$message({
                        message: "提交失败",
                        type: "error"
                    });
                    console.error(error);
                });

        }
        ,onFileSubmit() {
            console.log("onFileSubmit");
            const file = this.$refs.fileInput.files[0];
            const formData = new FormData();
            formData.append('file', file);

            axios.post('/uploadFile', formData, {
                headers: {
                    'Content-Type': 'multipart/form-data'
                }
            })
                .then(response => {
                    // 处理成功响应
                    this.$message({
                        message: "提交成功",
                        type: "success"
                    });
                    console.log(response.data);
                })
                .catch(error => {
                    // 处理错误响应
                    this.$message({
                        message: "提交失败",
                        type: "error"
                    });
                    console.error(error);
                });
        }
    };
    const app = Vue.createApp(App);
    app.use(ElementPlus);
    app.mount("#app");
</script>



<!--<form action="./uploadFile" method="post" enctype="multipart/form-data">-->
<!--    <h3>上传文件:</h3>-->
<!--    <input type="file" name="file" id="file">-->
<!--    <input type="submit" value="上传文件" name="submit">-->
<!--</form>-->

<!--<form action="./uploadText" method="post" enctype="multipart/form-data">-->
<!--    <h3>输入文本:</h3>-->
<!--    <textarea name="text" id="text"></textarea>-->
<!--    <input type="submit" value="提交文本" name="submit">-->
<!--</form>-->

</body>
</html>